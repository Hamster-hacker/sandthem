<h2><%= @dream.title%></h2>
<p><%= @dream.description%></p>
<p>Category: <%= @dream.category %></p>
<img src="<%= @dream.image_url%>" alt="<%= @dream.title%>" style="width:300px">
<p><strong>Price:</strong> <%= number_to_currency(@dream.price, unit: "â‚¬") %></p>

<p>
  <% hours = @dream.duration / 60 %>
  <% minutes = @dream.duration % 60 %>
  <% if @dream.duration > 60 %>
    <p>Duration: <%= "#{pluralize(hours, "hour")} #{pluralize(hours, "minute")} " %></p>
  <% elsif @dream.duration < 60 %>
    <p>Duration: <%= pluralize(@dream.duration, "minute") %> </p>
  <% else %>
    <p>Duration: <%= "#{pluralize(hours, "hour")}" %></p>
  <% end %>
</p>

<div>
  <% if @average_rating > 0 %>
  <p>Rating: <%= @average_rating.round(1) %> / 5.0</p>
  <% end %>
<div>

<div>
  <% if current_user && @dream.bookings.exists?(user_id: current_user.id) && @user_review.nil? %>
  <%= link_to new_dream_review_path(@dream), class: "btn btn-secondary", title: "Add a Review" do %>
      Add a Review
    <% end %>
  <% elsif !@user_review.nil? %>
    <div class="user-review">
      <h4>Your Review</h4>
      <p><strong>Title:</strong> <%= @user_review.title %></p>
      <p><strong>Description:</strong> <%= @user_review.description %></p>
      <p><strong>Rating:</strong> <%= @user_review.rating %> / 5.0</p>
    </div>
  <% end %>
</div>

<% if !@dream.is_owner?(current_user) %>
    <%= render "booking", dream: @dream, booking: @booking %>
<% end %>

</div>

<div>
  <%= link_to "Back to HomePage", dreams_path %>
  <% if @dream.is_owner?(current_user) %>
    <%= link_to dream_path(@dream),
                data: { turbo_method: :delete, turbo_confirm: "Are you sure?" },
                class: "text-danger", title: "Delete Dream" do %>
      <i class="fas fa-trash-alt"></i>
    <% end %>
    <%= link_to edit_dream_path(@dream), class: "text-warning me-3", title: "Edit dream" do %>
      <i class="fas fa-edit"></i>
    <% end %>
  <% end %>
</div>
